\chapter{Делимость и многочлены от многих переменных}

Настала пора вернуться к незаконченной теме про делимость. В этой связи мы снова вернёмся к предположению, что все кольца коммутативны. На этот раз мы поговорим подробно о кольце многочленов от $n$ переменных. Мы знаем, что кольцо многочленов $K[x]$ над полем $K$ является областью главных идеалов и вывели из этого однозначность разложения на множители в $K[x]$. Есть ли надежда повторить тоже самое для многочленов от двух и более переменных? 

Ответ на этот вопрос даёт следующий пример: рассмотрим идеал, порождённый независимыми переменными $x,y$ в кольце $K[x,y]$. Этот идеал нельзя породить одним элементом.

Однако мы интуитивно представляем то, что разложение многочленов на множители однозначно. Математически такое свойство кольца называлось факториальностью.

\dfn
Область целостности $R$ называется факториальным кольцом, если для любого $a\in R$, что $a\neq 0$  существует представление $a=\eps p_1\dots p_k$, где $\eps \in R^*$, а $p_1,\dots,p_k$ -- простые элементы $R$.
\edfn

\rm Исходя из определение простоты, такое разложение единственно с точностью до ассоциированности. Действительно, если $f=\eps\prod p_i= \delta \prod q_j$, то $p_1 \di \prod q_j$ и благодаря простоте делит скажем $q_1$. Но тогда $p_1h=q_1$, откуда, благодаря неприводимости $q_1$ получаем, что $h$ обратим, то есть, что $p_1 \sim q_1$. Тогда можно сократить на $p_1$ и продолжить по индукции.
\erm


\rm В факториальном кольце есть НОД любых двух элементов (естественно, с точностью до ассоциированности).
\erm


Итак, наша ближайшая цель поговорить о факториальности колец многочленов. Однако, для приложений к теории чисел нам будет необходимо разработать теорию в достаточной общности, чтобы применить её и над $\Z$, а не только над полем. Заметим, что $\Z$ и поле $K$ являются факториальными кольцами. Мы покажем, что факториальность кольца влечёт факториальность кольца многочленов над ним, что полностью ответит на наши вопросы.

Для этого доказательства нам понадобится конструкция факторкольца, важность которой мы почувствуем позднее.

\dfn Пусть $R$ кольцо, а $I\leq R$ -- идеал. Тогда на факторгруппе $R/I$ можно ввести структуру кольца определив умножение по формуле $\ovl{a}\ovl{b}=\ovl{ab}$. 
\edfn

\dfn Идеал $I$ называется простым, если выполнено, что $ab\in I$, то $a\in I$ или $b\in I$.
\edfn

\rm Элемент $p\in R$ отличный от нуля прост тогда и только тогда, когда идеал $(p)$ прост, тогда и только тогда, когда $R/(p)$ -- область целостности.
\erm


\section{Многочлены над факториальным кольцом}

Наша задача обсудить, что происходит с кольцом многочленов от многих переменных.


\lm[Гаусс] Пусть $R$ -- кольцо. Тогда любой простой элемент $p$ из $R$ остаётся простым в $R[x]$.
\proof
Теоретически удобно воспользоваться следующим соображением: чтобы показать, что элемент прост надо показать, что идеал $(p)$ в $R[x]$ прост, а для этого необходимо и достаточно установить, что $R[x]/(p)$ есть область целостности. Как же описать $R[x]/(p)$? Я утверждаю, что оно изоморфно $(R/p)[x]$. Действительно, из $R[x]$ есть отображение в $(R/p)[x]$, которое берёт все коэффициенты по модулю $p$. Очевидно, в его ядре лежат ровно те многочлены, все коэффициенты которых делятся на $p$, то есть многочлены кратные $p$ в $R[x]$. Но ровно они и образуют идеал $(p)$. Осталось заметить, что кольцо $R/p$ и, вслед за ним, кольцо $R/p[x]$ являются областями целостности.

У этого доказательства есть другая, более элементарная реинкарнация. А именно, формально нам надо доказать, что если произведение двух многочленов $f(x)g(x)$ делится на $p$ (то есть все коэффициенты кратны $p$), то тогда какой-то из них делится на $p$. Пусть это не так. Возьмём тогда у $f$ и у $g$ самые младшие коэффициенты $a_i$ и  $b_j$, которые не делятся на $p$. Тогда посмотрим на коэффициент с номером $i+j$  в произведении. Он имеет вид $c_{i+j}= a_ib_j + \sum_{k \neq i} a_k b_{i+j -k}$. Я утверждаю, что $c_{i+j}$ не делится на $p$. Для этого заметим, что любое слагаемое в сумме делится на $p$, так как либо $k<i$ и тогда $a_i \di p$, либо $k>i$, то есть $i+j-k<j$ и следовательно $b_j \di p$. Противоречие с тем, что $c_{i+j}$ должен делиться на $p$.   
\endproof
\elm

\upr Поясните, почему оба доказательства одинаковы.
\eupr

\dfn Пусть $f(x)$ -- многочлен над факториальным кольцом $R$. Тогда содержанием $f$ называется $\cnt(f)=\Nod (a_i)$, где $a_i$ коэффициенты $f$. 
\edfn

Следующее следствие тоже называют леммой Гаусса.

\crl Если $f(x)=g(x)h(x)$, где $f,g,h \in R[x]$, то $\cnt(f)=\cnt(g)\cnt(h)$
\proof Для начала, упростим задачу, то есть сведём задачу к случаю $\cnt g= \cnt h =1$. Для этого надо рассмотреть многочлены $\frac{g}{\cnt g}$ и $\frac{h}{\cnt h}$. Их произведение есть $\frac{f}{\cnt{g}\cnt{h}}$ имеет содержание $\frac{\cnt f}{\cnt g \cnt h}$ и если показать его единичность, то мы добьёмся требуемого. Итак считаем, что $\cnt g= \cnt h=1$. Если $\cnt f$ не обратим, то $\cnt f \di p$, где $p$ простой элемент из $R$. Но тогда один из $g$ или $h$ делится на $p$ благодаря простоте $p$. 
\endproof
\ecrl


\lm Пусть для многочлена $f(x) \in R[x]$  имеет место разложение $f(x)=g(x)h(x)$, где  $g(x), h(x) \in Q(R)[x]$. Пусть $c \in Q(R)^*$, такая что $cg \in R[x]$ и $\cnt(cg)=1$. Тогда $c^{-1}h \in R[x]$, что означает, что $f(x)=cg(x)c^{-1}h(x)$ -- есть произведение двух многочленов из $R[x]$ пропорциональных исходным.
\proof Для начала отметим, что такая константа $c$ существует. Заменяя $g$ на $cg$ можно считать, что $c=1$. В этом предположении нам надо доказать, что $h\in R[x]$.
Домножим $h$ на $d\in R$, так что $dh \in R[x]$. Тогда $df=g dh$ и значит
$$d\cnt f = \cnt(g) \cnt(dh)=\cnt(dh).$$
Таким образом, коэффициенты $dh$ делятся на $d$, а значит исходный $h$ был из $R[x]$.
\endproof
\elm

Заметим, что для любого ненулевого многочлена $g(x)$ указанная в лемме константа всегда существует. Теперь нам легко доказать теорему.


\thrm Пусть $R$ -- факториальное кольцо. Тогда кольцо $R[x]$ факториально. Более того, имеет место следующее описание простых элементов кольца $R[x]$ с точностью до ассоциированности:\\
1) $f\in R[x]$ такой, что $cont(f)=1$ и $f$ неприводим в $Q(R)[x]$.\\
2) $f=p \in R$ -- простой в $R$.
\proof 
Для начала покажем, что все указанные ситуации приводят к простым элементам в кольце $R[x]$.
Итак, пусть $f \in R[x]$ неприводим в $Q(R)[x]$ и $cont(f)=1$. Если $gh\di f$ в $R[x]$, то это же верно в $Q(R)$. По условию $f$ неприводимый, а значит простой в $R[x]$ и можно считать, например, что $g\di f$ в $Q(R)[x]$. Тогда $g= fh$. Тогда $h\in R[x]$, по лемме. Значит, $g \di f$ в $R[x]$. Второй случай непосредственно следует из леммы Гаусса.


Теперь покажем, что любой элемент $R[x]$ раскладывается в произведение указанных простых. Для этого сначала разложим $f$ в $Q(R)[x]$ в произведение неприводимых $f=\prod g_i$, $g_i \in Q(R)[x]$. Далее сделаем из $g_i$ элементы $\hat{g}_i$ из $R[x]$ с $cont(g_i)=1$. Тогда $f=a\prod \hat{g}_i$, где $a\in Q(R)$. Заметим, что $a\in R$ по лемме. Осталось разложить $a$ на простые из $R$.
\endproof
\ethrm








\section{Признаки неприводимости для многочленов}

Теперь наша задача поговорить про неприводимость многочленов над целыми числами или над $\Q$. 
Прежде всего отметим, что обе задачи тесно связаны. А именно, если взять многочлен с рациональными коэффициентами, то домножив его на подходящую рациональную константу мы получим многочлен с целыми коэффициентами и содержанием 1, который по доказанному ранее неприводим тогда и только тогда, когда неприводим исходный. Обратно, неприводимость целочисленных многочленов интересна только в случае, когда содержание этих многочленов равно единице. А в этом случае это эквивалентно рациональной неприводимости. Однако все теоремы я буду формулировать в общем контексте.



\thrm[Редукционный критерий] Пусть $R$ факториальное кольцо, $f \in  R[x]$ многочлен, а $p$ -- простой элемент. Тогда, если старший коэффициент $f$ не делится на $p$ и $\ovl{f}$ неприводим в кольце $R/p[x]$, то он неприводим над $Q(R)$. 
\proof Прежде всего перейдём от многочлена $f$ к $\frac{f}{cont(f)}$ с содержанием равным 1. Достаточно доказать неприводимость  последнего над $Q(R)$, которая эквивалентна его неприводимости над $R$. Итак пусть $cont(f)=1$ и пусть $f=gh$, где $g,h$ --  не константы. Старшие коэффициенты $g$ и $h$ тоже не делятся на $p$. Имеем $\ovl{f}= \ovl{g}\ovl{h}$ и $\deg g = \deg \ovl{g}$ и $\deg h = \deg \ovl{h}$, что даёт нетривиальное разложение $\ovl{f}$ и приводит к противоречию.
\endproof
\ethrm

Вот примеры о том, как пользоваться этим критерием и что не надо забывать про условие со старшим коэффициентом. 


\exm\\
1) Многочлен $x^3+x+1$ неприводим над $\F_2=\Z/2$, потому что у него нет корней. Следовательно многочлены $3x^3+8x^2+5x+7$ и скажем, $5x^3-4x^2+x+15$ неприводимы над $\Q$.\\
2) Рассмотрим многочлен $px^2+x$. Он приводим, но по модулю $p$ -- неприводим.\\
3) Критерий из теоремы сформулирован не в самом сильном виде. А именно, представим себе, например, что по модулю 2 многочлен степени пять разложился в произведение двух неприводимых степени 2 и 3, а по модулю 3 -- в виде произведения степени 4 и 1. Ясно, что он неприводим.\\
4) Не стоит забывать, что если многочлен неприводим над $\R$, то он так же неприводим над $\Q$. Это, правда, очень слабый критерий, но в комбинации с пунктом 3) может что-то дать.\\
5) Есть, однако, такие многочлены, которые неприводимы, но раскладываются по модулю любого простого. Например, $x^4+1$. Действительно,
$$x^4+1=(x-e^{\frac{i\pi}{8}})(x-e^{\frac{3i\pi}{8}})(x-e^{\frac{5i\pi}{8}})(x-e^{\frac{7i\pi}{8}})= (x^2+i)(x^2-i)=(x^2+\sqrt{2}x+1)(x^2-\sqrt{2}x+1)=(x^{2}+\sqrt{-2}x+1)(x^{2}-\sqrt{-2}x+1).$$
Он не имеет рациональных корней, а любые множители степени 2 имеют нерациональный коэффициент. Значит он неприводим.

С другой стороны, по любому нечётному простому модулю либо из $-1$, либо из $2$ либо из $-2$ извлекается корень. Случай $p=2$ легко проверяется руками.
6) Но не всё так плохо. Если мы зафиксируем степень $d$ и рассмотрим множество многочленов $f(x)\in \Z[x]$ с коэффициентами, ограниченными некоторой константой $M$, то при $M$ стремящемся к бесконечности доля неприводимых многочленов будет стремиться к $1$, а среди них, доля многочленов, неприводимость которых можно проверить при помощи редукции так же стремится к $1$.\\


Покажем теперь некоторый критерий неприводимости, который применим в случае, если разложение по модулю $p$ получилось очень неудачное. А именно, представим себе, что $f(x) \equiv c x^n \mod p$. То есть многочлен развалился в произведение максимально возможного числа одинаковых множителей. Оказывается, что в этом случае неприводимость многочлена $f$ зависит от его класса по модулю $p^2$. Точнее:

\thrm[Признак Эйзенштейна] Пусть $R$ -- факториальное кольцо и $f(x)= a_0 + \dots + a_n x^n$. Если $a_n \ndi p$, все $a_i \di p$ при $i<n$, но $a_0\ndi p^2$, то многочлен $f(x)$ неприводим.
\proof
Предположим, что $f=gh$. Тогда $c x^n=\ovl{f}=\ovl{g}\ovl{h}$ в $R/p[x]$ и значит в $Q(R/p)[x]$. Но в поле разложение на неприводимые однозначно. Отсюда $\ovl{g}=ax^k$ и $\ovl{h}=b x^l$. Но тогда их младшие члены делятся на $p$ и, значит, $a_0\di p^2$. Противоречие. 
\endproof
\ethrm 

\upr Распишите это доказательство на языке элементов.
\eupr

Всё, что мы пока обсуждали не говорит ничего о том, как же разложить многочлен на неприводимые множители. Первое, что мы обсудим -- вопрос, почему эта задача в принципе разрешима.

Итак, пусть есть целочисленный многочлен $f(x)$ и мы хотим разложить его на множители. Мы будем искать разложение на целочисленные многочлены. Заметим, что хотя бы один из них обязан иметь степень меньшую, чем $[\frac{n}{2}]$. Вспомним о задаче интерполяции. Если $g$ -- искомый делитель $f$, то $g$ определяется своими значениями в $[\frac{n}{2}]+1$ точке, например в точках $0,1,\dots, [\frac{n}{2}]$. Более того, $f(i) \di g(i)$. Таким образом, набор $g(0),\dots, g([\frac{n}{2}])$ состоит из делителей $f(0),\dots,f([\frac{n}{2}])$. Найти все такие наборы -- конечный перебор. По каждому набору кандидат на делитель $g$ восстанавливается однозначно.

Прежде чем продвинуться дальше в исследовании разложения многочленов от одной переменной на множители стоит немного поговорить о задаче разложения многочленов от нескольких переменных. Сейчас мы увидим ещё один трюк от Кронекера, который позволит свести эту задачу к предыдущей.

\thrm[Трюк] Пусть $R$ -- кольцо. Тогда различным разложениям $f(x_1,\dots,x_n)\in R[x_1,\dots,x_n]$   соответствуют различные разложения $\hat{f}=f(x, x^d, x^{d^2}, \dots, x^{d^{n-1}})$ для $d$ больших $\max_{i=1}^n \{\deg_{x_i} f\}$.
\proof Пусть $f=g_1h_1=g_2h_2$ и пусть $g_1\neq g_2$. Покажем, что $\hat{g_1}\neq \hat{g_2}$. Для этого посмотрим что происходит с мономом $x^{\alpha}$ при указанном преобразовании если $\alpha_i < d$. Этот моном переходит в многочлен $x^{\alpha_1+\alpha_2d+\dots+\alpha_n d^{n-1}}$. Так как по условию все $\alpha_i<d$, то такая степень  $x^{\alpha_1+\alpha_2d+\dots+\alpha_n d^{n-1}}$ может быть получена при подстановке только из монома $x^{\alpha}$. Заметим теперь, что $\deg_{x_i} g_j \leq \deg_{x_i} f <d$. Следовательно мономы многочленов $g_j(x)$ однозначно восстанавливаются по мономам $\hat{g_j}$.
\endproof
\ethrm

Заметим так же, что в теореме указан и метод по которому из многочлена $\hat{g}$ можно восстановить многочлен $\hat h$,
К сожалению, не стоит ожидать взаимооднозначного соответствия между разложениями многочленов $f$ и $\hat{f}$. Например, многочлен $x_2^2$ раскладывается на два множителя одним способом. При $d=3$ его образ есть $x^6$ у которого 3 различных разложения.

Это очень неэффективный алгоритм разложения многочлена на множители. Он был предложен Кронекером ещё в 19-ом веке. В настоящее время известен полиномиальный алгоритм решения этой задачи (см. \href{http://www.math.leidenuniv.nl/%7Ehwl/PUBLICATIONS/1982f/art.pdf}{LLL-алгоритм}) \cite{LLL}. Обсудим, как этот алгоритм работает.

Для проверки неприводимости мы с успехом использовали информацию, полученную из разложения многочлена по модулю $n$. Вопрос -- нельзя ли эту же информацию использовать и в задаче разложения на множители? Оказывается можно.

Во-первых, если взять достаточно большой модуль $n$, заметно больший, чем коэффициенты в целочисленном разложении, то разложение $f$ по модулю $n$ с маленькими коэффициентами однозначно будет определять кандидата на целочисленное разложение. Это соображение встречается сразу с двумя проблемами -- первая -- не ясно какие есть ограничения на коэффициенты сомножителей, вторая -- разложений по модулю $n$ может быть много и нам не известно способа эффективно искать их.



Продвинемся в решении второго вопроса. Как же  выбрать достаточно большое число, по модулю которого удобно раскладывать многочлен $f$ на множители? Наибольшим удобством в решении задачи разложения обладают поля. В этом смысле возможно стоило бы искать разложение $f$ по модулю очень большого простого. Однако найти большое простое число довольно тяжело. Смотреть по модулю маленьких простых а потом пытаться склеивать разложение в духе китайской теоремы об остатках может банально не получиться (как в примере 3 -- неясно во что склеить два разных разложения). Оказывается наиболее оптимальный вариант такой: взять небольшое простое число $p$, разложить $f$ над $\Z/p$ а затем <<поднять>> это разложение по модулю $p^k$ для достаточно большого $k$. Как находить разложение многочлена $f$ на неприводимые над $\Z/p$ мы обсудим позже. А пока поясним как делать подъём такого разложения по модулю $p^k$.

\lm[Гензеля] Пусть $f \in \Z[x]$, со старшим коэффициентом 1. Пусть $\ovl{f}=gh$ в кольце $\Z/p[x]$, причём $(g,h)=1$ и у $g,h$ тоже единичные старшие коэффициенты. Тогда  для любого $k\geq 1$ существуют единственные по модулю $p^k$ многочлены $\hat{g}, \hat{h} \in \Z[x]$, cо старшим коэффициентом $1$, что
$$\ovl{f}=\hat{g} \hat{h} \mod p^k,\quad  \hat{g}\equiv g \mod{p}, \quad \hat{h}\equiv h \mod{p} \quad \text{и} \quad \deg h= \deg \hat{h}, \quad \deg g= \deg \hat{g}.$$
\proof Докажем это индукцией по $k$. Пусть по модулю $p^{k}$ уже построены подходящие многочлены $\hat{h}$ и $\hat{g}$ и мы хотим построить $\ovl{h}$ и $\ovl{g}$. Заметим, что благодаря единственности по модулю $p^k$, такие $\ovl{g}$ и $\ovl{h}$ обязаны совпадать с $\hat{h}$ и $\hat{g}$ по модулю $p^k$. Это означает, что по модулю $p^{k+1}$ 
$$\ovl{h} \equiv \hat{h}+p^ka(x)\pmod{p^{k+1}} \text{\,\, и\quad } \ovl{g} \equiv \hat{g} + p^kb(x)\pmod{p^{k+1}}.$$
Заметим, что многочлены $a(x)$ и $b(x)$  однозначно определяются по модулю $p$,  если известны $\ovl{g}$ и $\ovl{h}$ и по модулю $p$ должны иметь степени меньше чем степени $h(x)$ и $g(x)$ соответственно, для того, чтобы не изменить старший коэффициент. Покажем, что такие $a(x), b(x)$ существуют и единственны по модулю $p$. Заметим, что необходимо проверить лишь условие $f \equiv \ovl{g}\ovl{h} \pmod{p^{k+1}}$. Распишем
$$f\equiv \hat{g}\hat{h} + p^{k}(a(x)g + b(x)h) \pmod{p^{k+1}}.$$
Здесь мы заменили $\hat{h}$ и $\hat{g}$ по модулю $p$ и получили исходные многочлены $g$ и $h$ из $\Z/p[x]$. Заметим, что есть единственный такой многочлен $c(x)\in\Z/p[x]$, что $f-\hat{g}\hat{h}=p^kc(x) \pmod{p^{k+1}}$. Теперь для выполнения сравнения выше необходимо, чтобы  $$c(x)=a(x)g(x)+b(x)h(x)$$
У такого сравнения есть единственное решение в $\Z/p[x]$ при условии $\deg a(x)<\deg h(x)$ и $\deg b(x)< \deg g(x)$. Что и требовалось.
\endproof
\elm

Частным случаем разложения на множители служит разложение вида $f(x)=(x-x_1)g(x)$, соответствующее наличию корня. Именно его мы и разбирали раньше. 

\rm Стоит отметить, что условие на старший коэффициент $f$ не является обременительным, так как его легко изменить при помощи линейной замены переменных над $\Q$ и домножения на подходящую константу.
\erm

\zd Покажите, что не существует критерия неприводимости, который бы зависел только от остатков коэффициентов $f(x)$ по модулю фиксированной степени простого $p^k$ и работал бы для многочленов $f(x)$, у которых есть два различных неприводимых множителя по модулю $p$ 
\ezd


\section{Дополнительно: оценка на коэффициенты делителя}

Заведём  на пространстве многочленов скалярное произведение
$$\lan f(x), g(x)\ran = \sum a_ib_i,$$
где $a_i$ и $b_i$ -- коэффициенты $f$ и $g$. Теперь докажем лемму:

\lm Пусть $f\in \C[x]$ имеет вид $f=(x-\alpha)h$. Тогда $|f|=|(\alpha x-1)h|$.
\proof
Обозначим коэффициенты $h$ за $c_0,\dots, c_{n-1}$. Тогда 
$$|f|^2= |-c_0\alpha|^2+|c_0-c_1\alpha|^2+\dots+ |c_{n-1}|^2.$$
С другой стороны имеем
$$|(\alpha x-1)h|^2=|c_0|^2+|\alpha c_0-c_1|^2+\dots + |\alpha c_{n-1}|^2.$$
Распишем отдельно модуль $|\alpha c_i - c_{i+1}|^2$ и $|c_i-\alpha c_{i+1}|^2$:
$$|\alpha c_i - c_{i+1}|^2= |\alpha c_i|^2 + |c_{i+1}|^2 - 2\re \alpha c_i \ovl{c_{i+1}} \text{ и } |c_i-\alpha c_{i+1}|^2= |\alpha c_{i+1}|^2 + |c_{i}|^2 - 2\re \alpha c_i \ovl{c_{i+1}}.$$
Осталось заметить, что все слагаемые вида $|\alpha c_i|^2$, $|c_i|^2$ и $-2\re \alpha c_i \ovl{c_{i+1}}$ встречаются в первой и второй сумме ровно по одному разу.
\endproof
\elm

Сформулируем теорему:

\thrm
Пусть $f=a_0 + a_1x+\dots + a_n x^n \in \Z[x]$. Тогда для коэффициентов целочисленного делителя $f$ степени $m$ имеет место оценка
$$|b_j| \leq C_{m-1}^j |f| + C_{m-1}^{j-1}|a_n|.$$
\proof Пусть $g(x)$ -- некоторый многочлен. Имеем разложение $g(x)=b_m \prod_{i=1}^m (x-\alpha_i)$. Тогда рассмотрим многочлен 
$$h(x)=\prod_{|\alpha_i|\geq 1} (x-\alpha_i) \prod_{|\alpha_i|<1}(\alpha_ix-1).$$
Мы знаем по предыдущей лемме, что $|g|=|h|$. Определим величины
$$M(g)=\prod_{|\alpha_i|\geq 1} |\alpha_i|, \,\,\, m(g)=\prod_{|\alpha_i|<1}|\alpha_i|.$$
Тогда имеет место
$$|g|^2=|h|^2\geq |b_m|^2 (M(g)^2+m(g)^2).$$
Для этого заметим, что старший коэффициент $h$ по модулю есть $|b_n|m(g)$, а младший -- $|b_n|M(g)$, что и даёт неравенство. В частности применяя это к многочлену $f$ получаем, что
$$M(f) \leq \frac{|f|}{a_m},$$
То есть мы оценили некоторое выражение от корней многочлена $f$. Вернёмся пока к произвольному многочлену $g$. Имеем следующую оценку на его коэффициент:
$$|b_j| = |b_m| \left|\sum \alpha_{i_1}\dots \alpha_{i_{m-j}}\right| \leq |b_m| \left|\sum \beta_{i_1}\dots \beta_{i_{m-j}}\right|, $$
где $\beta=\max(1,|\alpha|)$.

Покажем лемму

\lm Пусть есть набор вещественных чисел $x_1,\dots,x_m\geq 1$, что $x_1\dots x_m=M$. Тогда для всех $0<j\leq n$ имеем $$\sigma_j(x_1,\dots,x_m) \leq C_{m-1}^j M+ C_{m-1}^{j-1},$$
где $\sigma_i(x_1,\dots,x_n)$ -- элементарный симметрический многочлен.
\proof Покажем, что максимум модуля $\sigma_j$ достигается, если $x_1=\dots=x_{m-1}=1$ и $x_m=M$. Рассмотрим, например, пару $x_1,x_2$. Если $x_1,x_2\neq 1$, то заменим её на пару $1,x_1x_2$. Покажем, что при этом значение $\sigma_j$ увеличилось. Действительно, в новой сумме изменились только слагаемые в которые входили только $x_1$ или только $x_2$. Выпишем их 
$$\sum_{2<i_2 \dots< i_j} x_1 x_{i_2}\dots x_{i_j}  + \sum_{2<i_2\dots} x_2 x_{i_2}\dots x_{i_j}= (x_1+x_2)\sigma_{j-2}(x_3,\dots,x_m)$$
и сделаем в них замену $x_1=1$ и $x_2=x_1x_2$. Получим
$$(1+x_1x_2)\sigma_{j-2}(x_3,\dots,x_m).$$
Осталось заметить, что $0< x_1x_2 -x_1 -x_2 + 1= (x_1-1)(x_2-1)$ в наших предположениях. Аналогично для других пар переменных.
Теперь 
$$\sigma_j(1,\dots,1,M)= C_{m-1}^{j-1}M + C_{m-1}^j.$$
\endproof
\elm

\noindent Заметим теперь, что произведение $\beta_i = M(g)$. Тогда по лемме
$$|b_j|\leq |b_m| (C_{m-1}^{m-j-1}M(g) + C_{m-1}^{m-j})=|b_m| (C_{m-1}^{j}M(g) + C_{m-1}^{j-1}).$$
Теперь пусть $f \di g $ в $\Z[x]$. Тогда $a_n \di b_m$ и $M(g)\leq M(f)$ так как корни $g$ являются корнями $f$. Отсюда
$$|b_j|\leq |b_m| (C_{m-1}^{j}M(g) + C_{m-1}^{j-1})\leq |a_n|(C_{m-1}^{j}M(f) + C_{m-1}^{j-1})\leq C_{m-1}^{j}|f| + C_{m-1}^{j-1}|a_n|.$$

\endproof
\ethrm



Это теорема показывает, что размер записи коэффициентов делителя полиномиально зависит от размера записи многочлена $f$.







\section{Результант и дискриминант}

Попробуем решить следующую задачу: как определить по коэффициентам многочлена, что они имеют общий множитель? Если имеет место нетривиальное разложение $f=hk_1$, $g=hk_2$, то степень $k_1$ меньше $\deg f=n$, а степень $k_2\leq \deg g=m$. Заметим, что тогда $fk_2-gk_1=0$. Обратно, если найдены такие $k_1$ и $k_2$, то у $f$ и $g$ есть общий множитель. Рассмотрим отображение $K[x]_{\leq m-1}\times K[x]_{\leq n-1} \to K[x]_{\leq n+m-1}$, заданное по правилу
$$(a(x),b(x)) \to a(x)f(x)+b(x)g(x).$$ 
Когда это отображение вырождено? Тогда и только тогда, когда есть многочлены маленьких степеней, что $a(x)f(x)=-b(x)g(x)$. Это происходит тогда и только тогда, когда у многочленов $f$ и $g$ есть общий множитель. С другой это происходит, если определитель матрицы этого линейного отображения в стандартных базисах обнуляется. Транспонирую эту матрицу и переставляя строки и столбцы приходим к определению:

\dfn Пусть многочлен $f(x)=a_0+\dots+a_nx^n$, а $g(x)=b_0+\dots+b_mx^m$. Тогда результантом многочленов $f$ и $g$ называется $$Res(f,g)=  \det 
\begin{pmatrix}
a_n & a_{n-1} & \cdots & a_0 & 0 & \cdots & 0 \\
0 & a_n & a_{n-1} & \cdots & a_0 & \cdots & 0 \\
\\
0 & \cdots &  a_n & a_{n-1} & a_{n-2} & \cdots &  a_0 \\
b_m & \cdots & b_1 & b_0 & 0 & \cdots & 0 \\
 \\
0 & \cdots & 0 & b_m & \cdots & b_1 & b_0 
\end{pmatrix}.$$
Эта матрица называется матрицей Сильвестра. 
\edfn

Результант двух многочленов может быть определён над любым кольцом. Посмотрим, что из этого можно вытащить. Что значит равенство нулю результанта по $y$ для двух многочленов $f(x,y) $ и $g(x,y)$ из $K[x,y]$? Их результант это многочлен $h(x)$. Рассмотрим точку $x_0$. Допустим, что старшие коэффициенты $f$ и $g$ не обращаются в 0 в точке $x_0$. Тогда равенство нулю результанта $h(x_0)$ -- это равенство нулю результанта многочленов $f(x_0,y)$ и $g(x_0,y)$, что означает, что у последних есть общий корень $y_0$. То есть у системы $f=g=0$ есть корень $(x_0,y_0)$. Таким образом корни результанта -- это  просто $x$-координаты решений системы, или точки, в которых старший коэффициент многочленов обращается в 0.


А что можно вывести из того факта, что у $Res(f,g)=n$ для двух многочленов из $\Z[x]$? Разложим $n$ на простые множители. Получим $n=p_1^{\alpha_1} \dots p_k^{\alpha_k}$. Допустим, что $p_i$ не делит старшие коэффициенты $f$ и $g$. Тогда $0=Res(f,g) \mod p_i $ есть $Res(\ovl{f}, \ovl{g})$ и следовательно по модулю $p_i$ у многочленов есть общий корень. Обратно, если у $f$ и $g$ есть общий корень по модулю $p_i$, то $Res(f,g)\di p_i$.

\dfn Дискриминантом многочлена $f=a_0+\dots +a_nx^n$ называется выражение 
$$D(f)=(-1)^{\frac{n(n-1)}{2}} a_n^{-1} Res(f,f').$$
Это полином от коэффициентов $f(x)$.
\edfn

\rm Над полем  дискриминант обнуляется тогда и только тогда, когда у многочлена есть есть общий делитель с его производной. Заметим, что в если у многочлена $f$ были кратные множители, то это условие выполнено. Это, как мы узнаем позднее, эти условия равносильны над любым конечным полем характеристики $p$ (это не всегда верно над бесконечным полем $K$). Правильная формулировка в этом случае такая: дискриминант многочлена над полем $K$ обнуляется тогда и только тогда, когда существует расширение поля $K$, в котором у этого многочлена есть кратные множители.  
\erm

Дискриминант даёт ответ на вопрос, когда многочлен не имеет кратных корней по модулю $p$. Действительно это происходит только тогда, когда $D(\ovl{f})=0$ (как мы скоро узнаем). Это происходит тогда и только тогда, когда $D(f)\ndi p$ или, если $a_n\di p$. Заметим, что это условие может нарушаться только в конечном числе $p$, если $D(f)\neq 0$. Таким образом, либо у целочисленного многочлена есть кратный множитель над $\Q$, либо у него нет кратных множителей по модулю почти всех простых $p$. Это обосновывает, что для применения леммы Гензеля для подъёма всегда можно выбрать подходящее простое, если сам многочлен $f\in \Z[x]$ был бесквадратный.


\subsection{Дополнительно: свойства результанта и дискриминанта}

\thrm Пусть многочлен $f(x)=a_0+\dots+a_nx^n$, а $g(x)=b_0+\dots+b_mx^m$ из кольца $K[x]$, где $K$ -- поле. Пусть так же в поле $K$ имеются разложения $f(x)=a_n\prod(x-x_i)$, а $g(x)=b_m\prod (x-y_j)$. Тогда
$$Res(f,g)=a_n^mb_m^n \prod_{i,j} (x_i-y_j),$$
\ethrm

\lm Пусть так же в поле $K$ имеются разложения $f(x)=a_n\prod(x-x_i)$, а $g(x)=b_m\prod (x-y_j)$. Тогда результант можно найти по формуле:
$$a_n^mb_m^n \prod_{i,j} (x_i-y_j)=(-1)^{mn}b_m^n \prod f(y_j)=a_n^m \prod g(x_i).$$ 
\elm

\upr Кроме того, если $f=gq+r$, где $\deg r=k$, то 
 $$Res(f,g)=(-1)^{(n-k)m}b_m^{n-k} Res(r,g).$$
\eupr

\lm Пусть $f(x)\in K[x]$ -- это многочлен вида $f(x)=a_n(x-x_1)\dots(x-x_n)$. Тогда дискриминант можно найти по формуле:
$$D(f)=a_n^{2n-2}\prod_{i< j} (x_i-x_j)^2.$$
\elm

\exm\\
1) $D(x^2+ax+b)=a^2-4b$.\\
2) $D(x^3+ax+b)=-4a^3-27b^2$.\\




\chapter{Конечные поля}

\section{Общие факты теории полей}

Мы с вами уже встречались с понятием расширения полей, то есть ситуацией, когда одно поле $K$ является подкольцом в поле $L$. В этой ситуации $L$ автоматически является векторным пространством над $K$ и более того $K$-алгеброй. Тогда у $L$ можно посчитать размерность над $K$, а у любого элемента $\alpha \in L$ можно искать минимальный многочлен. Вокруг этих двух понятий и будет идти разговор в этом разделе.  


\dfn[Степень расширения] Пусть $L$ расширение поля $K$ (в этой ситуации часто пишут $L/K$). Тогда $\dim_K L$ называется степенью $L$ над $K$ и обозначается как $[L:K]$. Если $[L: K]$ конечно, то говорят, что $L$ -- конечное расширение поля $K$. 
\edfn

\thrm[О башне полей] Пусть дана башня расширений $K\leq L \leq M$. Тогда 
$$[M: K]=[M: L][L: K].$$
В частности, если $M$ конечно над $L$, а $L$ конечно над $K$, то $M$ конечно над $K$.


\proof Пусть $u_1\dots,u_n$ -- базис $L/K$, а $v_1,\dots,v_m$ -- базис $M/L$. Утверждается, что набор $u_iv_j$ базис $M/K$.
Прежде всего заметим, что это порождающая система. Действительно, любой элемент $y\in M$ равен 
$$y=\sum_{j=1}^m \lambda_j u_j. $$
Здесь $\lambda_j \in L$, что значит, что для них есть разложение $\lambda_j=\sum_{i=1}^n \mu_{ij} u_i$, где $\mu_{ij}\in K$. Подставляя, получаем 
$$ y=\sum_{j=1}^m\sum_{i=1}^n \mu_{ij} u_jv_i.$$
Покажем теперь независимость этого набора. Пусть
$$\sum_{j=1}^m\left(\sum_{i=1}^n \mu_{ij}u_i\right)v_j=\sum_{ij}\mu_{ij} u_i v_j=0.$$
Тогда, так как набор $v_j$ образует базис $M/L$, то необходимо
$$\sum_{i=1}^n \mu_{ij}u_i=0 \text{ для всех j}.$$
Но так как $u_i$ -- базис $L/K$, получаем, что $\mu_{ij}=0$, что и требовалось.
\endproof
 
\ethrm

\crl Пусть $[L: K]$ -- конечное расширение степени $n$, а $[M:K]$ -- степени $d$. Тогда, если $d \ndi n$, то $M$ не может быть подрасширением $L/K$.
\ecrl

\rm Тут стоит быть осторожным, потому что одно и тоже поле может быть по разному реализовано как расширение базового. Рассмотрим простой пример: $\Q(x)$ содержит в качестве подполя $\Q(x^2)$, которое само изоморфно $\Q(x)$. В этой ситуации $\Q(x)$ реализовано как расширение самого себя двумя разными способами.
\erm

\dfn Пусть $L/K$ расширение полей, а $\alpha \in L$. Тогда наименьшее подрасширение $L$, содержащее $\alpha$, будем обозначать $K(\alpha)$, а наименьшую подалгебру, содержащую $\alpha$, будем обозначать $K[\alpha]$. Если есть несколько элементов $\alpha_1,\dots,\alpha_n\in L$, то аналогичные объекты будем обозначать как $K[\alpha_1,\dots,\alpha_n]$ и $K(\alpha_1,\dots,\alpha_n)$.
\edfn



Может показаться, что такое обозначение не естественно, потому что никак не включает в себя объемлющее поле $L$. Я покажу, что это не так страшно. Для этого нам понадобится определение:

\dfn Элемент $\alpha \in L$ называется алгебраическим над $K$, если существует многочлен $0\neq p(x)\in K[x]$, что $p(\alpha)=0$. Не алгебраические элементы называются трансцендентными.
\edfn 

Например, элемент $\sqrt{2} \in \R$ является алгебраическим над $\Q$, а элемент $\pi\in \R$ является трансцендентным.

Нам понадобится лемма:

\lm Пусть $f(x) \in K[x]$, а $L$ -- какая-то алгебра над $K$. Тогда задание  гомоморфизма $K$-алгебр $K[x]/f \to L$ равносильно нахождению элемента $\alpha \in L$, что $f(\alpha)=0$.
\elm
\proof Класс $\ovl{x}$ является корнем $f(x)$ в алгебре $K[x]/f$. При гомоморфизме он должен перейти в корень $f$ в $L$. Так как алгебра $K[x]/f$ порождена $\ovl{x}$, образ $\ovl{x}$ однозначно задаёт гомоморфизм. 
Осталось показать, что если найдётся подходящее $\alpha\in L$, то гомоморфизм существует. Для этого сначала построим гомоморфизм $K[x] \to L$ по правилу $h(x) \to h(\alpha)$. А потом заметим, что он продолжается на фактор. Заметим, что всё сказанное работает и при $f=0$.
\endproof


\thrm Пусть $L/K$ расширение полей, а $\alpha \in L$. Тогда если $\alpha$ алгебраический над $K$, то 
$$K(\alpha)=K[\alpha]\cong K[x]/p(x),$$
 где $p(x)$ минимальный многочлен для $\alpha.$
Если же $\alpha$ трансцендентное над $K$, то $$K[\alpha]\cong K[x] \text{ и } K(\alpha) \cong K(x).$$
\ethrm


\proof Итак, пусть $\alpha$ -- алгебраический над $ K$. Тогда минимальный многочлен $\alpha$ однозначно определён. Покажем, что он неприводим. Пусть $p(x)=h(x)q(x)$. Тогда $h(\alpha)q(\alpha)=0$. Но $L$ -- поле. Откуда либо $h(\alpha)=0$ либо $q(\alpha)=0$. Но тогда $p(x)$ не минимальный.

Существует единственный гомоморфизм $\ffi \colon K[x]/p(x) \to L$ переводящий $x \to \alpha$.  Это даёт гомоморфизм $K[x]/p(x) \to L$. Он инъективен, так как $K[x/p(x)$ -- поле. Значит  образ $K[x]/p(x)$ тоже поле. Оно состоит из линейных комбинаций $1,\alpha,\dots,\alpha^{n-1}$, где $n$ -- степень $p(x)$. Понятно, что любая подалгебра, содержащая $\alpha$ содержит такие элементы. Значит образ -- это наименьшая подалгебра содержащая $\alpha$. Отсюда
$$K[x]/p(x) \cong \im \ffi = K[\alpha]=K(\alpha).$$
Пусть $\alpha$ не алгебраический, то есть трансцендентный. Тогда отображение $K[x] \to L$ переводящее $x\to\alpha$ инъективно. Ясно, что его образ это $K[\alpha]$. Далее заметим, что это отображение продолжается до отображения $K(x) \to L$, потому что образы всех элементов $K[x]$, кроме 0 в $L$ обратимы. Ясно, что образ этого отображения есть подполе и изоморфен $K(x)$. С другой стороны, меньше чем образ этого отображения быть ничего не может. Тогда образ и есть $K(\alpha)$. 
\endproof

\crl Пусть $\alpha$ -- алгебраическое. Тогда $ [K[\alpha]:K]= [K[x]/p(x):K]= \deg p(x)$, где $p(x)$ -- минимальный многочлен $\alpha$.
\ecrl

\crl Все расширения, порождённые над $K$ корнем одного и того же неприводимого многочлена изоморфны. Часто я буду говорить, про расширение $K[\alpha]$, где $\alpha$ корень многочлена $p(x)$. Это корректно, так как такое расширение определено однозначно с точностью до изоморфизма.
\ecrl

Так же напомню вам факт, известный ещё с прошлого года:

\utv Пусть $K$ -- поле, $f(x)$ -- многочлен над $K$. Тогда существует такое конечное расширение $L/K$, что в $L$ многочлен $f$ раскладывается на линейные множители.
\eutv
\proof Индукция по степени многочлена. Рассмотрим многочлен $f$. Пусть у $f$ есть неприводимый множитель $g$. Построим расширение $L=K[x]/g$. В этом расширении у $g$, а значит и у $f$ есть корень $\alpha$. Посмотрим на многочлен $f_1=f/(x-\alpha) \in L[x]$. По индукции построим для $L$ расширение $M$ в котором $f_1$ раскладывается на линейные множители. Но тогда в $M$ и многочлен $f$ раскладывается на линейные множители.
\endproof

На самом деле построенное при помощи этой конструкции расширение есть <<наименьшее>> расширение, которое содержит все корни многочлена и можно показать, что оно единственно с точностью до изоморфизма. Такое расширение называется полем разложения многочлена.


\subsection{Дополнительно: построение при помощи циркуля и линейки}
Попробуем применить это следствие для доказательства невозможности определённых  построений, например при помощи циркуля и линейки. Напомню, что при построении циркулем и линейкой можно поставить пару начальных точек (задать масштаб), соединять две построенные  точки прямой и строить окружность с центром в построенной точке и с расстоянием, равным расстоянию между уже построенными двумя точками. Точка построена, если она есть точка пересечения построенных прямых и окружностей. 

Вещественное число $x$ называется построимым, если, стартуя с точек $(0,0)$ и $(1,0)$, можно построить отрезок $(x,0)$. 

\thrm Если вещественное число $x$ построимо, то оно алгебраическое и лежит в расширении $L/\Q$ степени $2^m$.
\proof Доказательство идёт индукцией по числу построений. Пусть уже построены прямые $l_i$ и окружности $O_j$. Заметим, что коэффициенты в уравнениях $O_i$ и $l_j$ по индукционному предположению лежат в подполе $L\subseteq \R$ степени $2^m$ над $\Q$. Это же касается и новой прямой $l$ (или окружности $O$). Посмотрим на пересечение окружности $O_j$ и новой прямой $l$. Оно задано системой уравнений $(x-a)^2+(y-b)^2=r^2$ и $cx+dy=f$. Пусть $c\neq 0$. Тогда первое уравнение переписывается в виде $$(f-dy)^2+c^2(y-b)^2=c^2r^2$$
Его коэффициенты из $L$, а решение $y$ лежит либо в $L$ либо в расширении степени 2 над $L$. Случай пересечения двух окружностей сводится к пересечению окружности и прямой.  Действительно, если написаны два уравнения окружности c разными центрами
$$(x-a_1)^2+(y-a_2)^2=r^2_1 \text{ и } (x-b_1)^2+(y-b_2)^2=r^2_2$$
то вычитая их получим уравнение прямой
$$2(a_1-b_1)x+2(a_2-b_2)y=r^2_2-r^2_1+a_1^2-b_1^2+a_2^2-b_2^2.$$

\endproof
\ethrm

\crl
Нельзя разбить произвольный угол на три части при помощи циркуля и линейки.
\proof Например, угол $\frac{\pi}{3}$ нельзя, потому что угол $\frac\pi 9$ не построить. Действительно, построимость угла и его косинуса равносильны. Косинус $\frac{\pi}{9}$ удовлетворяет уравнению $4x^3-3x=\frac{1}{2}$. Это неприводимый над $\Q$ многочлен степени 3 и его корни не могут лежать в расширении степени $2^m$. Следовательно, построение невозможно. 
\endproof
\ecrl

\section{Строение конечных полей}

В качестве затравки мы ограничим возможное число элементов в конечном поле.

\lm Пусть $K$ --- поле, $p=\chr K$ --- простое число. Тогда в $K$ есть подполе изоморфное $\Z/p$. Если к тому же $K$ --- конечное, то число элементов $|K|=p^n$ для некоторого натурального $n$. 
\elm


\proof Рассмотрим гомоморфизм $f\colon \Z \to K$. Ядро этого отображения это $p\Z$. Тогда $\im f\cong \Z/p$. Пусть теперь $K$ конечно. Тогда $K$ -- конечномерное векторное пространство над $\Z/p$ и в нём $p^n$ элементов.
\endproof
 
Теперь сформулируем основной результат про конечные поля, который мы и будем в дальнейшем доказывать.

\thrm Существует и единственно (с точностью до изоморфизма) поле из $p^n$ элементов. Такое поле будем обозначать $\F_{p^n}$.
\ethrm

Начнём с леммы:
\lm Пусть $K$ поле из $p^n$ элементов. Тогда все элементы $K$ удовлетворяют уравнению $x^{p^n}=x$.
\elm
\proof Группа $K^*$ состоит из $p^n-1$ элементов. Тогда все элементы из $K^*$ удовлетворяют уравнению $x^{p^n-1}-1=0$. Домножая на $x$ добавляем неприкаянный 0.
\endproof


\lm Пусть $L$ --- кольцо характеристики $p$, где $p$ -- простое. Тогда отображение $x\to x^{p}$ является эндоморфизмом $L$. Это отображение называется эндоморфизмом Фробениуса. Если $L$ --- конечное поле, то эндоморфизм Фробениуса является автоморфизмом. 
\elm
\proof Очевидно произведение переходит в произведение. Для суммы имеем $$(x+y)^p=\sum_{i+j=p} C_p^i x^iy^j= x^p+y^p,$$ т.к. все промежуточные биномиальные коэффициенты делятся на $p$. Пусть теперь $L$ -- поле. Тогда заметим, что отображение $\Frob$ инъективно, так как в поле не бывает нильпотентов и, следовательно, по принципу Дирихле, биективно.
\endproof

\rm Условие конечности поля в этой ситуации важно. Рассмотрим, например, поле $\Z/p(x)$. Тогда возведение в $p$-ую степень в качестве образа имеет $\Z/p(x^p)$.
\erm

\lm Пусть $L$ --- поле характеристики $p$. Тогда множество элементов из $L$ удовлетворяющих уравнению $x^{p^n}=x$ образует подполе в $L$.
\elm
\proof Обозначим рассматриваемое множество за $K$. Тогда $0,1\in K$. Очевидно, что $K$ замкнуто относительно умножения. Замкнутость относительно сложения следует из того, что $x^{p^n}$ есть композиция $n$ раз эндоморфизма Фробениуса. Значит $K$ --- подкольцо. Обратный к $x\neq 0$ имеет вид $x^{p^n-2}$, что следует из уравнения.
\endproof
 

\proof[{\color{red!80!black} Доказательство теоремы. Существование}]
Рассмотрим поле $\F_p=\Z/p$ и $x^{p^n}-x$ --- многочлен над ним. Тогда есть поле $L$ в котором   $x^{p^n}-x$ раскладывается на линейные множители. Рассмотрим $K$ --- подполе в $L$ состоящее из элементов удовлетворяющих уравнению $x^{p^n}=x$. В $K$ ровно $p^n$ элементов т.к. многочлен $x^{p^n}-x$ не имеет кратных корней.

\proof[{\color{red!80!black} Доказательство теоремы. Единственность}]
Пусть есть два поля $K$ и $L$ из $p^n$ элементов. Рассмотрим их мультипликативные группы. Они циклические порядка $p^n-1$. Пусть группа $K^*$ порождена элементом $\xi$. Тогда любой элемент заведомо является многочленом от $\xi$. Пусть $f$ -- минимальный многочлен $\xi$. Значит $K\cong\F_p[x]/f(x)$. Многочлен $f$ неприводим. $\xi$ --- его корень. Многочлен $x^{p^n}-x$ делится на $f$, так как $\xi$ есть корень $x^{p^n}-x$, а $f$ -- минимальный многочлен.

Тогда у $f$ есть корни в любом поле из $p^n$ элементов, в частности в $L$. Тогда у нас есть гомоморфизм  $K\cong\F_p[x]/f(x)\to L$ переводящий $\xi$ в некоторый корень $f$ в $L$. Этот гомоморфизм инъективен, так как $K$ -- поле и, по принципу Дирихле, является биекцией. 
\endproof
 
\rm В частности, мы увидели, что любое конечное поле $\F_{p^n}$ может быть построено как $\F_p[x]/f(x)$, где $f$ -- неприводимый многочлен степени $n$.
\erm

\noindent{\bf Пример:}\\
Построим поле из $4=2^2$ элементов. Для этого нам нужно найти неприводимый многочлен степени $2$ над $\F_2$. Это $x^2+x+1$. Тогда построим поле из четырёх элементов как
$$\F_4= \F_2[x]/x^2+x+1.$$

Когда одно конечное поле может быть подполем в другом и сколько может быть вариантов для выбора такого подполя?

\thrm Поле $\F_{p^n}$ подполе $\F_{p^m}$ тогда и только тогда, когда $m\di n$. Такое подполе единственно.
\ethrm 
\proof
Если $\F_{p^n}$ подполе $\F_{p^m}$, то сравнивая степени расширения получаем, что $m \di n$. Обратно, возьмём в $\F_{p^m}$ подполе $\{x \in \F_{p^m} \,|\, x^{p^n}-x=0\}$. Очевидно, что любое подполе из $p^n$ элементов там содержится. Это даёт единственность. 


Для того, чтобы доказать существование, покажем, что в указанном подполе $p^n$ элементов. Для этого заметим, что многочлен $x^{p^m}-x \di x^{p^n}-x$, если $m \di n$. Первый многочлен раскладывается на линейные множители над $\F_p$, откуда аналогичное свойство выполнено для второго многочлена. То есть у многочлена $x^{p^n}-x$ есть все $p^n$ корней в $\F_{p^m}$. Что и требовалось. 
\endproof
 



\crl Элемент $\alpha\in \F_{p^m}$ лежит в подполе из $p^n$ элементов тогда и только тогда, когда $\alpha^{p^n}-\alpha=0$.
\ecrl

Так же, если внимательно посмотреть на доказательство основной теоремы, то можно увидеть ещё несколько закономерностей.

\utv Пусть $f(x) \in \F_p[x]$ -- неприводимый многочлен степени $n$. Многочлен $f(x)$ раскладывается над $\F_{p^n}$ на линейные множители. Кроме того $x^{p^m}-x \di f(x)$ тогда и только тогда, когда $m\di n$. Кроме того, если $\alpha$ --  корень $f$, то все остальные его корни имеют вид $\alpha^{p^k}$ при $0\leq k<n$. 
\eutv
\proof Рассмотрим многочлен $f$ и поле $\F_p[x]/f$ из $p^n$ элементов. Корень $f$ в этом поле удовлетворяет уравнению $x^{p^n}-x=0$ и потому  $x^{p^m}-x \di f$. Тогда $f$ раскладывается в $\F_{p^n}$ на линейные множители. 

Если $x^{p^m}-x \di f$, то все корни $f$, которые порождают поле из $p^n$ элементов, лежат в $\F_{p^m}$. Но тогда $m \di n$. Обратно, если $m\di n$, то $x^{p^m}-x\di x^{p^n}-x\di f$.

Так как возведение в $p$-ую степень автоморфизмом поля $\F_{p^n}$ над $\F_p$, то если $\alpha$ корень $f$, то $\alpha^p$ тоже корень $f$. Почему таким образом получаются все корни? Для этого достаточно показать, что корни $\alpha$ и $\alpha^{p^k}$ не склеиваются при всех $k<n$. Но они не могут быть одинаковыми, так как тогда возведение в степень $p^k$ и тождественное отображение $\F_{p^n} \to \F_{p^n}$ совпадали бы (ведь $\F_{p^n}$ порождается $\alpha$), а это противоречит описанию всех автоморфизмов.
\endproof


Кроме того, посмотрим, как устроены все автоморфизмы конечных полей.

\utv Все автоморфизмы $\F_{p^n}$  имеют вид $\Frob_p^{\circ i}$, где $0\leq i \leq n-1$. Все указанные автоморфизмы различны.
\proof Обозначим $q=p^n$. Заметим, что поле $\F_q$ порождено одним элементом $\F_q =\F_p[\alpha]$. Минимальный многочлен $\alpha$ над $\F_p$ обозначим за $f$, его степень равна $n$. 

Теперь, гомоморфизмы $\F_p[\alpha]$ в себя определяются образами элемента $\alpha$, которые обязаны быть корнями того же многочлена $f$. Но таких корней в $\F_p[\alpha]$ не более $n$. Тогда и автоморфизмов не более $n$. Осталось показать, что мы нашли все $n$ возможных. Для этого надо показать, что автоморфизмы $\Frob_p^{\circ i}$ различны для всех $0\leq i\leq n-1$. Предположим, что для всех элементов из $\F_q$ выполнено, что $\Frob_p^{\circ l} - \Frob_p^{\circ k}=0$, для $k<l<n$. Но это уравнение степени меньше $p^n$ и оно не может иметь $p^n$ решений в поле $\F_q$. 
\endproof
 
\eutv


\subsection{Расширения конечных полей}

Говоря про конечные поля характеристики $p$, мы рассматриваем их как расширения поля $\F_p$. Но что происходит, с расширениями больших конечных полей $\F_q$, где $q=p^n$? Оказывается, что все те свойства расширений, которые мы сформулировали над $\F_p$, в  подходящем виде верны и над $\F_q$. Сформулируем их. 



\thrm Все конечные расширения поля $\F_q$, где $q=p^n$ имеют $q^m$ элементов. Два расширения $\F_q$ из $q^m$ элементов изоморфны между собой над $\F_q$. Внутри поля $\F_{q^m}$ есть подполе $\F_{q^l}$ только если $l|m$.
\proof
Если $L$ расширение $\F_q$, то оно имеет $q^{[L:\F_q]}$ элементов. Покажем существование. Возьмём поле из $q^m=p^{nm}$ элементов и рассмотрим в нём подполе $\F_q$ из $q=p^n$ элементов. Такое есть по предыдущей теореме. Так как все поля из $q$ элементов изоморфны, то мы можем отождествить  и даёт необходимое расширение. 

Покажем, что все расширения $\F_q$ из $q^m$ элементов изоморфны над $\F_q$. Применим ту же логику что и в ситуации над $\F_p$. А именно, рассмотрим некоторое расширение $K$ из $q^m$ элементов. Оно порождено одним элементом $\alpha$ над $\F_q$. Минимальный многочлен $f$ для $\alpha$ над $\F_q$ имеет общий корень с $x^{q^m}-x$ и, значит, делит его. Значит в любом другом расширении из $q^m$ элементов есть корень $f$. В него и надо отправить $\alpha$.

Теперь рассмотрим поле из $q^m$ элементов. Тогда в нём есть подполе из $q^l$ элементов только если $nm \di nl$. Но это происходит только если $m \di l$. Такое подполе единственно и автоматически снабжается структурой $\F_q$ расширения, так как содержит образ последнего при его вложении в $\F_{q^m}$.
\endproof
\ethrm

Теперь рассмотрим свойства неприводимых многочленов над конечным полем $\F_q$.

\crl Пусть $f(x)$ -- это неприводимый многочлен из $\F_q[x]$. Тогда $x^{q^m}-x \di f(x)$ тогда и только тогда, когда $\deg f(x) | m$. Если многочлен $f$ имеет корень $\alpha$ в $\F_q^m$, то он раскладывается над этим полем на линейные множители. Все корни $f$ в этой ситуации можно найти как $\alpha^{q^k}$. 
\proof Пусть $x^{q^m}-x$ делится на $f(x)$. Тогда в поле $\F_q^m$ многочлен $f(x)$ имеет корень $\alpha$ (на самом деле там лежат все его корни). Теперь $\F_q[\alpha]$ подполе $\F_{q^m}$. Но тогда $\deg f(x) = [\F_q[\alpha]: \F_q] \di m $. 

Обратно, пусть $k=\deg f(x) | m$. Тогда в $\F_q^m$ есть подполе $\F_{q^k}$. Но такое подполе изоморфно $\F_q[x]/f$ и имеет внутри корень $\alpha$ многочлена $f(x)$. Но тогда $f(x)$ и $x^{q^m}-x$ не взаимно просты, откуда следует, что $x^{q^m}-x \di f(x)$, благодаря неприводимости последнего. 
\endproof
\ecrl


\utv Все автоморфизмы $\F_{q^m}$ над $\F_q$ есть композиции отображения $x \to x^q$ с самим собой.
\eutv
\proof Для начала стоит заметить, что отображение $x\to x^q$ является $\F_q$-линейным и, значит, автоморфизмом над $\F_q$. Остальное повторяет рассуждения над $\F_p$.
\endproof

\section{Алгоритм Берлекэмпа}


Я опишу здесь некоторый набор соображений и алгоритмов касательно разложения многочленов на множители над конечным полем. 

Мы помним, что над полями характеристики 0 всегда легко выделить все  кратные множители многочлена просто взяв отношение $f$ и $\Nod(f,f')$. Однако, над конечными полями всё немного не так. Точнее

\lm Пусть $f= \prod g_i^{n_i}\in \F_q[x]$, где  $q=p^n$, $g_i$ неприводимы над $\F_q$. Тогда
$$\Nod(f,f')=\prod_{n_i \not\di p} g_i^{n_i-1} \prod_{n_i \di p}g_i^{n_i}.$$
\proof
Рассмотрим неприводимый множитель $g_i$. Пусть $f(x)=g_i(x)^{n_i}g(x)$. Продифференцируем. Имеем $f'(x)= n_ig_i'(x)g_i^{n_i-1}g(x)+ g_i^{n_i}g'(x)$. Если $n_i\di p$, то $f'(x)=g_i^{n_i}g'(x)$, что показывает, что степень вхождения $g_i$ в $f'(x)$ не менее $n_i$. Но в $f(x)$ многочлен $g_i$ входит с кратностью ровно $n_i$. А значит с такой кратностью он входит и в $\Nod(f,f')$.

Если же $n_i\ndi p$, то кратность вхождения $g_i(x)$ в $f'(x)$ равна $n_i-1$, что следует из следующей леммы.
\endproof
\elm

\lm Многочлен $h$ над конечным полем характеристики $p$ имеет нулевую производную тогда и только тогда, когда он является $p$-ой степенью. Извлечение степени можно провести эффективно.
\proof Как мы уже знаем с прошлого семестра, если $h'=0$, то $h=g(x^p)$. Посмотрим на коэффициенты $g$ -- $a_0, \dots, a_l\in \F_q$. Вспомним, что эндоморфизм Фробениуса $\Frob \colon \F_q \to  \F_q $ -- биекция. Иными словами из каждого элемента можно извлечь корень степени $p$. Пусть $b_i^p=a_i$. Тогда $f=b_0+b_1x+\dots+b_lx^l$ обладает свойством $f^p=g(x^p)=h$. Как вычислить корень степени $p$ из элемента? Для этого заметим, что обратное отображение к $\Frob \colon \F_q \to \F_q$ это $\Frob^{\circ n-1}$. 
\endproof
\elm 


Это позволяет свести задачу разложения произвольного многочлена над конечным полем к разложению на множители многочлена без кратных множителей. Действительно $\frac{f}{\Nod(f,f')}$ без кратных множителей. В свою очередь $\Nod(f,f')$ состоит из множителей двух типов -- чьи степени кратны $p$ и не кратны $p$. Первые встречаются как сомножители в  $\frac{f}{\Nod(f,f')}$ и легко находятся после получения его разложения. Из оставшихся множителей можно извлечь корень степени $p$ и перейти к разложению многочлена заведомо меньшей степени. 



Прежде чем мы перейдём к, собственно, к разложению на неприводимые множители. Для того, чтобы разложить многочлен на неприводимые множители достаточно научиться получать его нетривиальный делитель. Теперь вспомним факт про многочлены.

\fct[Китайская теорема об остатках] Пусть $K$ -- поле и в $K[x]$ выполнено равенство $f(x)=g(x)h(x)$, где $g,h$ взаимно простые многочлены. Тогда
$$K[x]/f \simeq K[x]/g \times K[x]/h.$$
\efct


\thrm[Алгоритмы Берлекэмпа] Пусть $f(x)\in \F_q$ без кратных множителей. Тогда существуют детерминированный полиномиальный по $n$ (но не по $\log q$)  алгоритм раскладывающий $f$ на множители. 


\proof Первое соображение, которое мы применим, будет состоять в том, что мы переформулируем  задачу факторизации многочлена $f$ как задачу про некоторое кольцо. Точнее, пусть $f=h_1\dots h_l$ разложение на неприводимые. Тогда по Китайской теореме об остатках 
$$R= \F_q[x]/f\cong \F_q[x]/h_1 \times \dots \times \F_q[x]/h_l.$$ 
Заметим, что нахождение нетривиального делителя нуля в $R$ равносильно нахождению делителя $f$. Заметим, что, в свою очередь, $\F_q[x]/h_i$ -- поле из $q^{\deg h_i}$ элементов. Делителем нуля является любой элемент с хотя бы одним нулём в компоненте.


В каждом таком поле есть единственное подполе из $q$ элементов, состоящее из решений уравнения $x^q-x=0$. Если рассмотреть множество решений этого уравнения в $R$, то оно будет состоять из $l$-ек покомпонентных решений. Иными словами множество решений уравнения $x^q-x$ в $R$ есть подалгебра $R'$, изоморфная $\F_q\times \dots \times \F_q$, взятое $l$ раз. Если мы найдём делитель нуля в этой подалгебре, то найдём и в исходной. Заметим, что удельно, делителей нуля в этой подалгебре больше чем в исходной. 

Как найти $R'$? Для этого надо найти все решения уравнения $x^q-x=0$ в $R$. Второе соображение состоит в том, что это уравнение линейно (над $\F_q$). Чтобы решить это линейное уравнение надо составить его матрицу. У отображения $x \to -x$ матрица $-E_n$, где $n=\deg f$. У оператора $x \to x^q$ матрица легко считается. Далее достаточно применить любой из методов для решения систем линейных уравнений. Заметим, что если алгебра $R'$ одномерна (она не менее чем одномерна, так как константа всегда решение), то многочлен $f$ неприводим.

Теперь мы нашли $R'$. Построим детерминированный алгоритм нахождения разложения. Напомню, что нам надо получить делитель нуля, то есть элемент, у которого хоть одна компонента равна 0, но сам он не ноль. Возьмём произвольный не константный элемент $h$ из $R'$.  Тогда $h$ соответствует $l$-ка $(a_1,\dots,a_{l})$.  Переберём все константы $c$ из $\F_q$. Их $q$ штук (это и даёт неполиномиальность алгоритма по $\log q$). Тогда $h-c$ для, например, $c=a_1$ есть нетривиальный делитель 0 (он не ноль, потому что $h$ не константа).

Делитель $f$ теперь можно найти как $\Nod(f,h-c)$.

\endproof
\ethrm

\rm Несмотря на то, что алгоритм Берлекэмпа является неполиномиальным по размеру входных данных он даёт полиномиальный способ проверки неприводимости многочлена. А именно, многочлен неприводим тогда и только тогда, когда размерность подалгебры $R'$ над $\F_q$ равна 1.

С другой стороны, во многих приложениях в качестве базового поля берётся $\F_2$ и проблема с неполиномиальностью по размеру поля отпадает.
\erm


\subsection{Дополнительно: алгоритм Кантора-Цассенхауза}

Рассмотрим полиномиальный, но вероятностный алгоритм нахождения делителей:

\thrm[Алгоритмы Кантора-Цассенхауза] Пусть $f(x)\in \F_q$ без кратных множителей, $q\neq 2^d$. Тогда существуют вероятностный полиномиальный по $n\log q$  алгоритм раскладывающий $f$ на множители.
\proof
Будем предполагать, что $f(x)$ имеет в качестве неприводимых делителей многочлены степени ровно $d$. Тогда алгебра $R$ имеет вид
$$R= \F_q[x]/f(x)\cong \F_{q^d}\times \dots \times \F_{q^d}.$$ 
Наша задача придумать вероятностный алгоритм находящий делитель нуля в таком произведении.

Для упрощения обозначений я заменю $q^d$ на $l$. Посмотрим отдельно на один сомножитель $\F_{l}$. Заметим, что любой элемент поля $\F_l$ удовлетворяет условию, что $x^{\frac{l-1}{2}}$ либо 0, либо 1, либо $-1$. Ноль реализуется только в случае $x=0$, а $1$ и $-1$, если $x$ квадрат и не квадрат соответственно. Из этого стоит пояснить, что, если $x$ не квадрат, то $x^{\frac{l-1}{2}}$ элемент порядка 2 (и следовательно равен $-1$). Действительно, любой элемент $\F_l^*$ есть степень первообразного корня $\alpha$. Тогда элемент квадрат  только если он есть $\alpha^{2d}$. В свою очередь, элемент $\alpha^{2d+1}$ не может быть тривиальным, потому что порядок $\alpha$ чётен. В частности, $(\alpha^{2k+1})^{\frac{l-1}{2}}$ с одной стороны имеет порядок либо 2, либо 1 и при этом не тривиален, то есть имеет порядок 2.


Возьмём теперь случайный элемент $a$ из $R$. Если $a$ делитель нуля всё и так хорошо. Это можно проверить взяв $\Nod(f,a)$, который заодно вычислит делитель $f$. Иначе с вероятностью больше чем  $\frac{1}{2}$ одна из компонент $a$ в одном из сомножителей $\F_l$ является квадратом, а ещё одна не является квадратом. Не умоляя общности пусть это первая и вторая компоненты. Тогда $a^{\frac{l-1}{2}}$ имеет вид $(1,-1,\dots)$ и $a-1$ является нетривиальным делителем нуля.  
\endproof
\ethrm

Этот алгоритм не работает для полей характеристики 2. Это не страшно, потому что над $\F_2$ итак хорошо работает алгоритм Берлекэмпа. А если вы хотите что-то над расширением $\F_2$ то есть подход, использующий не $x^{l-1/2}-1$, а другой многочлен (вычисляющий след). 

В алгоритме Кантора-Цассенхайза есть условие, что многочлен $f$ должен раскладываться на неприводимые множители одинаковой степени. Может показаться, что это обременительное условие, но на самом деле этого легко добиться, если заметить, что $(f,x^{q^d}-x)$ легко вычисляется и вспомнить, какие у этого многочлена могут быть неприводимые делители.


\section{Коды исправляющие ошибки}

Одно из применений конечные поля находят при решении задачи о кодах исправляющий ошибки. Постановка вопроса следующая: Алиса хочет передать Бобу сообщение, но канал связи может искажать часть передаваемого. Задача состоит в том, чтобы так закодировать сообщение, что, даже если оно было немного изменено по дороге, тем не менее, можно было бы восстановить исходный текст.

Дадим математическую постановку задачи. Пусть мы работаем с некоторым конечным алфавитом $\mc A$. Часто -- это двухэлементное множество $\{0,1\}$. Но если вы передаёте байты целиком и не лезете в их потроха, то ваш алфавит состоит из  $2^8$ символов.  Сообщение -- это строка фиксированной длины из элементов $\mc A$. Что означает, что при передаче сообщения возникает не более чем  сколько-то ошибок? Одна ошибка -- это изменение в одном символе. Не более $r$ ошибок -- изменение не более $r$ символов. Это удобно выражать на следующем языке:

\dfn[Расстояние Хемминга] Пусть дан некоторый алфавит $\mc A$ и два слова $x,y \in \mc A^n$. Тогда расстоянием Хемминга между ними называется число позиций, в которых эти слова различаются
$$d_H(x,y)=|\{i \in \ovl{1, n} \, |\, x_i \neq y_i \}|.$$
\edfn

Итак, у нас происходит не более чем $r$ ошибок, если сообщение до передачи $x$ находится от сообщения после передачи $y$ на расстоянии не более чем $e$.

Что такое кодирование? Пусть исходные сообщения, которые надо передать, были длины $k$. Никто не говорил, что передавать надо именно их. Вместо них мы можем передавать слова другой длины, или даже слова в другом алфавите. Впрочем, менять алфавит мы не собираемся, особенно, когда речь идёт о передаче электронных данных. 

А вот размер сообщения мы можем поменять. Зафиксируем $n\in \N$. Тогда кодированием (блочным) назовём инъективное  отображение $K\colon \mc A^k \to \mc A^n$.

Итак, мы кодируем сообщения длины $k$ в сообщения блины $n$. Что значит, что мы можем исправить $r$ ошибок? Пусть $x\in \mc A^k$. Если при передаче произошло не более $r$ ошибок, то переданное сообщение $y \in \mc A^n$ обладает тем свойством, что $d_H(K(x),y)\leq r$. Для того, чтобы мы могли однозначно восстановить по $y$ кодовое слово $K(x)$, должно выполняться свойство, что для всех других $z\in \mc A^k$ верно, что $d_H(K(z),y) > r$.

Если мы потребуем, чтобы восстановление было возможно всегда, то  это равносильно условию, что все шары радиуса $r$ с центрами в точках вида $K(x)$ не пересекаются. Заметим, что это условие за висит не столько от отображения $K$, сколько от его образа. Это приводит к определению

\dfn Пусть дан алфавит $\mc A$ из $q$ символов. Тогда $[n,k]_q$-кодом назовём  $C \subseteq A^n$ размера $|C|=q^k$.  Если $q=2$, то говорят, что код бинарный.
\edfn

\dfn Будем говорить, что такой код исправляет $r$ ошибок, если для любых двух слов $x\neq y \in C$ верно, что $B_r(x) \cap B_r(y)= \varnothing$. 
\edfn

Попробуем немного переформулировать это определение. Что значит, что два шара радиуса $r$ с центрами в двух точках не пересекаются? Это значит, что расстояние между этими точками больше $2r$. И наоборот, если расстояние между двумя точками больше $2r$, то два таких шара не пересекаются. Введём определение:

\dfn Пусть $C$ -- код. Тогда кодовым расстоянием называется величина
$$d(C)= \min_{\substack{x,y\in C \\ x \neq y}} d_H(x,y).$$
\edfn

Тогда, если $d=2t$ или $d=2t-1$, то код $C$ исправляет  $r=t-1$ ошибок. Но число $d$ не только определяет число исправляемых ошибок. Оно имеет свой смысл. А именно, если совершено меньше чем $d$ ошибок, то мы с уверенностью можем сказать, что ошибки в принципе были. Это полезно, если вы хотите не восстанавливать ошибки, а, например, запросить тот же кусок повторно в надежде, что он придёт без ошибок. В дальнейшем нас будет интересовать именно параметр $d$.

\dfn $[n,k,d]_q$-кодом называется $[n,k]_q$-код $C$ с кодовым расстоянием $d$.
\edfn

\section{Линейные коды}

Откуда брать такие коды $C$? Понятно, что можно просто брать и повторять сообщение несколько раз, но это крайне не эффективно. С другой стороны отображение $K \colon \mc A^k \to \mc A^n$ тоже играет свою роль, ведь от скорости его вычисления будет зависеть итоговая скорость передачи сообщения. Кроме того, процесс декодирования, особенно в ситуации когда известно, что допущена ошибка, тоже должен проходить быстро.

Для того, чтобы решить эти задачи нам нужно представить себе алфавит $\mc A$ и код $C$ не просто как множества. Нам нужно завести на них максимум возможных структур. А именно, мы будем считать, что  $q=p^n$ -- степень простого, $\mc A = \F_q$ -- конечное поле. В такой ситуации естественно потребовать, чтобы отображение $K$ было линейным над $\F_q$, а $C$, следовательно, было векторным подпространством в $\F_q^n$.

\dfn Линейным $[n,k]_q$-кодом называется $k$-мерное подпространство в $\F_q^n$.
\edfn

Если кодирование линейно, то оно задаётся матрицей размера $n\times k$ и ранга $k$, которая обозначается $G$ и называется {\it порождающей матрицей}. Одному коду могут соответствовать разные отображения кодирования и, следовательно, разные матрицы $G$. В столбцах матрицы $G$ записаны вектора, порождающие код $C$. 

Отметим, что в книжках по теории кодирования кодовые слова обычно являются строчками. В этом случае кодирующее отображение есть умножение на матрицу размера $k\times n$ справа. Именно эта матрица в такой интерпретации и будет называться порождающей. Перейти от одной конвенции к другой можно при помощи операции транспонирования.

\dfn Процедура кодирования называется систематической, если первая часть кодового слова состоит из исходного сообщения. Для порождающей матрицы это накладывает следующее ограничение на её вид: 
$$G= \pmat E_k\\ G' \epmat.$$
Такое кодирование заметно облегчает декодирование, если ошибок нет. В этой ситуации, оставшиеся $n-k$ символов кодового слова называются проверочными. Иногда сообщение помещают в конец, но это вопрос соглашения.
\edfn

Как узнать, есть ли ошибки и раскодировать обратно сообщение? Для этого заметим, что всякое подпространство $C$ размерности $k$ есть ядро матрицы $H$ размера $n-k\times n$ и ранга $n-k$. Такая матрица называется {\it проверочной матрицей кода} $C$. Часто коды удобно задавать при помощи проверочной матрицы. Любая матрица $H\in M_{n-k\times n}{\F_q}$ ранга $n-k$ задаёт линейный $[n,k]_q$ код. 

Посмотрим, как связаны порождающая $G$ и проверочная $H$ матрицы одного и того же кода $C$. Несложно заметить, что они удовлетворяют равенству $HG=0$. Обратно, если есть матрица $H$, такая что $HG=0$ и $\rk H=n-k$, то $H$ есть проверочная матрица для $C$.

Как можно построить проверочную матрицу? Если $G$ имеет вид
$$G= \pmat E_k\\ G' \epmat,$$
то $H$ всегда можно взять 
$$H=(-G'\,|\,E_{n-k}).$$
Заметим, что матрица $H$ является по совместительству порождающей матрицей $[n,n-k]_q$ кода. Это приводит к понятию двойственного кода к данному. Мы не будем говорить про это подробно.

Линейность кода позволяет упростить многие вычисления, например, нахождение кодового расстояния.



\lm Пусть $C$ -- линейный $[n,k]_q$ код. Тогда кодовое расстояние $d(C)$ вычисляется по правилу 
$$d(C)=\min_{\substack{x \in C \\ x\neq 0} } d_H(0,x).$$
Так же минимальное расстояние можно вычислить как наименьшее число линейно зависимых столбцов проверочной матрицы $H$.
\proof
Действительно, пусть минимальное расстояние достигается на паре $(x,y)$. Но тогда оно же достигается на паре $(0,y-x)$. Далее, кодовые слова и только они являются элементами ядра $H$, то есть коэффициентами в линейной комбинации столбцов, дающей в результате ноль. Но тогда, если бы было меньше чем $d$ линейно зависимых столбцов, то было бы  ненулевое кодовое слово с менее чем $d$ ненулевыми символами и наоборот. 
\endproof
\elm

\rm Если матрица $H$ не является проверочной, но выполнено, что код $C$ лежит в ядре $H$, то изложенное доказательство может дать оценку на кодовое расстояние. А именно, если любые $d-1$ столбцов матрицы $H$ линейно независимы, то кодовое расстояние больше или равно $d$. 
\erm 

\rm Расстояние Хэмминга от $x$ до $0$ есть просто количество ненулевых компонент в $x$. Эту величину часто называют весом вектора и обозначают $w(x)$ или $\|x\|$.
\erm 

Общий алгоритм декодирования систематических линейных кодов следующий: полученное сообщение $v= u+e$ ($u\in C$ -- исходное сообщение, а $e$ -- ошибка) подставляем в проверочную матрицу. Имеем 
$$Hv= He=s.$$
Вектор $s\in \F_q^{n-k}$ обычно называется синдромом. Если $s=0$, то ошибок нет и мы всего лишь выбрасываем проверочные символы. Если ошибки есть, но их можно исправить (то есть $w(e)\leq r$), то вектор $e$ однозначно определяются синдромом $s$. Действительно, пусть для двух векторов $e$ и $e'$ веса меньше или равно $r$ два синдрома совпадают $He=He'$. Тогда $e-e'\in \Ker H$ и $w(e-e')\leq 2r$ чего не может быть.

Далее, есть два способа исправить ошибки. Либо мы заранее посчитали для всех возможных $e$ значения $He$ и тогда мы просто находим $e$ по этим предварительным вычислениям. Это не так долго если кодовое расстояние маленькое. 

Либо, можно рассмотреть общее решение системы $He=s$. Оно имеет вид $v-Gx$, где $x$ -- произвольный вектор из $\F_q^k$. Тогда переберём все значения $x$ и найдём ближайший к нулю вектор вида $v-Gx$. Тогда $v-Gx$ есть вектор ошибки, а $x$ есть раскодированное сообщение.

У нас пока не было ни одного примера кодов. Как можно строить линейные коды? Предложим один вариант построения линейных кодов при помощи многочленов. 

Пусть дан произвольный многочлен $g(x)$ над $\F_q$, степени $s=\deg g < n$, то по нему можно построить код при помощи отображения $\F_q[x]_{\leq n-s-1} \to \F_q[x]_{\leq n-1}$, заданное правилом:
$$m(x) \to g(x)m(x).$$
Такое отображение линейно и инъективно. В его образе лежат все многочлены степени меньше $n$ делящиеся на $g(x)$ и они образуют $[n,n-s]_q$-код. Такие коды я буду называть полиномиальными. 

Почему такие коды удобно использовать? Прежде всего их использование позволяет ускорить процесс кодирования, так как домножить один многочлен на другой можно быстрее чем умножить матрицу на столбец. Кроме того, можно подобрать многочлен в котором много нулевых коэффициентов.

Правда указанный способ кодирования не является систематическим. Несложно построить пример систематического кодирования:
$$m(x) \to m(x)x^s-r(x), \text{ где } r(x)=x^s m(x) \mod g(x).$$
Здесь, строго говоря, $m(x)$ записан в последние биты.

\upr Как выглядит порождающая матрица для естественного кодирования? А как для систематического?
\eupr

Так же, мы получаем некие бонусы в вопросах проверки наличия ошибок. А именно, в качестве проверки того, лежит $v(x)$ в коде или нет, достаточно найти остаток от деления $v(x)$ на $g(x)$.   

Если же нам известны все корни $\alpha_i$ многочлена $g(x)$ и они не кратные, то делимость $v(x)\di g(x)$ равносильна условию $v(\alpha_i)=0$. Более того, от одного неприводимого множителя $g(x)$ достаточно взять по одному корню.

Примерами применения таких кодов являются \href{https://ru.wikipedia.org/wiki/%D0%A6%D0%B8%D0%BA%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B8%D0%B7%D0%B1%D1%8B%D1%82%D0%BE%D1%87%D0%BD%D1%8B%D0%B9_%D0%BA%D0%BE%D0%B4}{CRC}.
Название CRC расшифровывается как {\it Cyclic Redundancy Check}. Слово {\it Check} подчёркивает то, что эти коды используются, прежде всего, не для восстановления ошибок, а для их обнаружения. А что же в этих кодах циклического?

\subsection{Дополнительно:  циклические коды}

\dfn Код $C\leq \F_q^n$ называется циклическим, если для всякого слова $(a_0,\dots,a_{n-1})\in C$ слово $(a_{n-1},a_0,\dots,a_{n-2})$ тоже из $C$. 
\edfn

\rm Забавно, но не все CRC-коды на самом деле циклические. Но все они полиномиальные.
\erm


Встаёт вопрос: а как цикличность кода связана с полиномиальностью. Оказывается, что напрямую -- любой циклический код обязан быть полиномиальным. Для этого мы посмотрим на следующее соображение: удобно рассматривать пространство $\F_q^n \cong \F_q[x]_{\leq n-1}$ не просто как векторное пространство над $\F_q$, а как алгебру. Например, отождествив это пространство с $\F_q[x]/x^n-1$. А в качестве кодов будем смотреть только идеалы $C \subseteq \F_q[x]/x^n-1$. Если расписать условие, что $C$ идеал, то получим следующее утверждение

\thrm Пусть $C$ подпространство в $\F_q[x]/x^n-1$. Тогда $C$ идеал в том и только том случае, когда $C$ является циклическим кодом.
\ethrm
\proof Домножение на $x$ в этой алгебре соответствует сдвигу, а вся алгебра порождаетcя элементом $x$.
\endproof

Многочлены уже появились на арене. На вопрос, откуда вязть многочлен $g(x)$ отвечает следующий факт, дающий описание всех идеалов в $\F_q[x]/x^n-1$.

\fct Пусть $K$ -- поле. Делителю $g(x)$ многочлена $f(x)$ можно сопоставить главный идеал в $K[x]/f(x)$. Идеалы в кольце $K[x]/f(x)$ однозначно соответствуют делителям $f$ со старшим коэффициентом $1$.
\efct

Итого, все идеалы в $\F_q[x]/x^n-1$ главные и соответствуют делителям многочлена $x^n-1$. Чтобы задать идеал необходимо задать многочлен $g(x)$, такой что $ x^n-1 \di g(x)$. Это даёт линейный $[n, n-\deg g]_q$ циклический код.

Определение циклического кода появилось в самом начале прикладного использования кодов, исправляющих ошибки. Его важность была обусловлена простотой аппаратной реализации проверки на принадлежность коду. А именно, рассмотрим многочлен $\hat{g}=f/g$. Тогда элемент $v \in \F_q[x]/x^n-1$ делится на $g$ тогда и только тогда, когда $\hat g v \equiv 0 \mod x^n-1$. 
Произведение многочленов и взятие по модулю $x^n-1$ удачно реализовывались аппаратно при помощи {\it сдвиговых регистров с обратной связью}.



\section{Коды БЧХ}

Мы пока не научились двум вещам о полиномиальных кодах: оценивать кодовое расстояние у полиномиальных кодов и строить эффективный алгоритм исправления ошибок. Займёмся расстоянием.

Для оценки кодового расстояния мы воспользуемся некоторой информацией про порождающий полином $g(x)\in \F_q[x]$. Итак, пусть мы строим код над $\F_q$ длины $n$ и так получилось, что все корни многочлена $g(x)$ не кратны, лежат в $\F_{q^m}$ и являются степенями одного и того же элемента $\beta\in \F_q^*$ порядка $r$. Построим  множество степеней $T=\{i\in\ovl{0,r-1} \,|\, g(\beta^i)=0\}$, отвечающих корням многочлена $g(x)$. Немедленно замечаем, что $|T|=\deg g \leq r$.  

Чтобы оценить кодовое расстояние, нам необходима проверочная матрица или что-то вроде того. Можем ли мы предъявить проверочную матрицу для кода, заданного $g(x)$?

И да и нет. Нам будет удобнее думать не про матрицу, а про линейное отображение. Заметим, что для $f(x)\in \F_q[x]$ верно, что $f(x) \di g(x)$ тогда и только тогда, когда $f(\beta^i)=0$ для $i\in T$. Это приводит к следующей <<проверочной матрице>> $H$:
$$H=\pmat 1& \beta^{i_1}& \dots& \beta^{i_1(n-1)}\\
\vdots &&\dots&\vdots\\
1& \beta^{i_k}& \dots & \beta^{i_k(n-1)}
\epmat.$$
Слова <<проверочная матрица>> стоят в кавычках, потому что $H$ матрица не над $\F_q$, а над $\F_{q^m}$. Впрочем, легко сделать из неё матрицу над $\F_q$ переписав $\beta^i$ через базис $\F_{q^m}$. Докажем теперь основную теорему:

\thrm Пусть корни порождающего многочлена $g(x)$ кода длины $n$ есть степени элемента $0\neq \beta \in \F_{q^m}$ и $g(x)$ не имеет кратных корней. Пусть $\ord \beta \geq n$. Пусть в множестве $T$ есть $d-1$ идущие подряд индексов. Тогда минимальное расстояние кода длины $n$ заданного $g(x)$ больше или равно $d$.
\ethrm
\proof
Пусть подряд идущие $d-1$ элементов $T$ имеют следующий вид $l_0, l_0+1,\dots,l_0+d-2$. Нам надо показать, что у матрицы $H$ любые $d-1$ столбцов линейно независимы над $\F_q$. Нам удобно проверить независимость её столбцов не над $\F_q$, а над $\F_{q^m}$.

Возьмём столбцы с номерами $j_1,\dots,j_{d-1}$ и оставим только строки с номерами $l_0, l_0+1,\dots,l_0+d-2$. Получим матрицу 
$$ \pmat 
\beta^{l_0 j_1}& \dots &\beta^{l_0 j_{d-1}}\\
\vdots & & \vdots\\
\beta^{(l_0+d-2)j_1} & \dots & \beta^{(l_0+d-2)j_{d-1}} 
\epmat.$$
Нам достаточно показать, что её определитель не ноль. Найдём его. Из $s$-го столбца вынесем $\beta^{l_0j_s}$. Имеем
$$ \det \pmat 
\beta^{l_0 j_1}& \dots &\beta^{l_0 j_{d-1}}\\
\vdots & & \vdots\\
\beta^{(l_0+d-2)j_1} & \dots & \beta^{(l_0+d-2)j_{d-1}} 
\epmat = \beta^{l_0(j_1+\dots+j_{d-1})} \det  \pmat 
1& \dots &1\\
\vdots & & \vdots\\
\beta^{(d-2)j_1} & \dots & \beta^{(d-2)j_{d-1}} 
\epmat.$$
Но определитель последней матрицы есть определитель Вандермонда для элементов $\beta^{j_1}, \dots, \beta^{j_{d-1}}$. Этот определитель не обращается в ноль так как $\beta^{j_k}\neq \beta^{j_l}$, при $0\leq k< l\leq n-1< \ord \beta -1$.
\endproof

Перейдём к основной конструкции кодов, для которых применима эта лемма --  кодам Боуза -- Чоудхури -- Хоквингема.

Зафиксируем числа $q=p^s$ степень простого, натуральные числа $n$  и $m$, такие, что $(q^m-1)\di n$, а так же число $2\leq d\leq n$ и $l_0 \leq n$. $m$ обычно минимально возможное при данном $n$. Из условия делимости $q^m-1\di n$ следует, что в поле $\F_q^m$ есть элемент порядка $n$. Его несложно найти зная первообразный корень $\alpha$ в $\F_{q^m}$. Действительно, можно взять 
$$\beta=\alpha^{(q^m-1)/n}.$$ 

Рассмотрим элементы $\beta^{l_0},\beta^{l_0+1},\dots, \beta^{l_0+d-2}$ и рассмотрим $g(x)$ -- многочлен наименьшей степени, корнями которого являются эти элементы. Тогда кодом БЧХ длины $n$ c конструктивным расстоянием $d$ назовём циклический код длины $n$, порождённый полиномом $g(x)$.

\rm
Заметим, что $g(x)$ делит $x^n-1$ и поэтому код действительно циклический.
\erm

\noindent {\bf Пример:}\\
Пусть $q=2$. Возьмём $n=2^4-1=15$ (то есть $m=4$). Для того, чтобы построить поле из 16 элементов рассмотрим многочлен $x^4+x^3+1$. Он неприводим над $\F_2$. Его корень $\alpha$ -- первообразный корень степени $15$ из единицы. Возьмём $l_0=1$ и $d=5$. Тогда необходимо найти минимальные многочлены для элементов $\alpha,\alpha^2,\alpha^3,\alpha^4$. Заметим, что минимальные многочлены для $\alpha,\alpha^2,\alpha^4$ одинаковы и равны $x^4+x^3+1$ так как два последних элемента есть образы предыдущих при автоморфизме Фробениуса. Минимальный многочлен для $\alpha^3$ равен $x^4+x^3+x^2+x+1$. 

В качестве многочлена, задающего соответствующий код БЧХ с расстоянием $5$, берём $$g(x)=(x^4+x^3+1)(x^4+x^3+x^2+x+1).$$
Итого, получили $[15,7,d\geq 5]_2$-код.

\upr Постройте проверочную матрицу для этого кода.
\eupr

Частным случаем кодов БЧХ являются коды Рида-Соломона. Обобщение, использующее многочлены от нескольких переменных называется кодами Рида-Мюллера.

\subsection{Декодирование БЧХ-кодов}

Поговорим о декодировании кодов БЧХ. Опишем простейший алгоритм декодирования -- алгоритм Питерсона-Горенштейна-Цирлера.

Пусть нам дан БЧХ-код длины $n$ с конструктивным расстоянием $d$. Корни порождающего многочлена этого кода есть $\beta^{l_0},\dots, \beta^{l_0+d-2}$.
Пусть на вход мы получили многочлен $v(x)=u(x)+e(x)$, где $u(x)$ -- это пересылаемое закодированное сообщение, а $e(x)$ -- ошибка. Предположим, что $e(x)=e_{i_1}x^{i_1}+\dots +e_{i_t}x^{i_t}$ состоит из $t$ мономов, где $t\leq [(d-1)/2]$, то есть мы теоретически можем раскодировать сообщение. Для того чтобы узнать, что ошибки есть, мы вычисляем $v(\beta^{i})$, где $i\in \ovl{l_0, l_0+d-2}$. Но так как $u(x) \di g(x)$, то
$$v(\beta^{i})=u(\beta^i)+e(\beta^i)=e(\beta^i).$$
Итого мы знаем значения $e(\beta^i)$. Обозначим за
$$S_k= e(\beta^{l_0+k-1}), \text{ при } k\in \ovl{1,d-1}, \,\, X_s=\beta^{i_s} \text{ и } \eps_s=e_{i_s} \text{ при } s\in \ovl{1,t}.$$
Заметим, что эти определения эти элементы связаны следующим соотношением 
$$S_k=\sum_{s=1}^t \eps_s X_s^{l_0+k-1}.$$

Если известны $X_s$, то из указанных выше уравнений легко найти $\eps_s$. Определитель матрицы этой системы при $k\in\ovl{1,t}$ есть,  определитель Вандермонда, что гарантирует однозначность решения.

Итого, необходимо найти элементы $X_k$. Уравнения на $X_k$ не линейны. Наша задача ввести новые величины, однозначно определяющие $X_k$, на которые уже можно написать линейные уравнения. Для этого рассмотрим многочлен 
$$\chi(x)=(x-X_1)\dots(x-X_t)= x^t+\sigma_1x^{t-1}+\dots+\sigma_t.$$
Корни этого уравнения -- это величины $X_1,\dots,X_t$. Если мы найдём $\sigma_i$, то сможем найти $X_i$.

Заметим, что последовательность $S_k$ есть сумма геометрических прогрессий с частными $X_1,\dots,x_t$. Каждая из таких прогрессий является решением линейного рекуррентного соотношения с постоянными коэффициентами у которого характеристический многочлен в точности $\chi(x)$. Это означает, что у нас есть система уравнений 
$$\left\{ \begin{array}{rcl}
-S_{t+1}&=& \sigma_t S_1+\dots + \sigma_1 S_t\\
&\vdots&\\
-S_{2t}&=& \sigma_t S_t+\dots + \sigma_1 S_{2t-1}\\
\end{array} \right.$$
Теоретически, можно написать выражения для всех элементов вплоть до $S_{d-1}$, но нам это не понадобится. Разрешимость этой системы зависит от её матрицы, которая имеет вид 
$$ \Sigma_t =\pmat
S_1 & \dots & S_t\\
\vdots & & \vdots\\
S_t & \dots & S_{2t-1}
\epmat.
$$
 

Заметим, однако, что кроме того, что нам надо решить систему нам надо найти её размер, то есть число ошибок $t$. Для того, чтобы ответить на оба эти вопроса, напишем аналогичные матрицы для всех $\tau$  от $1$ др $[(d-1)/2]$ 
$$ \Sigma_\tau=\pmat
S_1 & \dots & S_\tau\\
\vdots & & \vdots\\
S_\tau & \dots & S_{2\tau-1}
\epmat =  \pmat
1 & \dots & 1\\
\vdots & & \vdots\\
X_1^{\tau-1} & \dots & X_t^{\tau-1}
\epmat
\pmat
\eps_1X_1^{l_0} & \dots & 0\\
\vdots & \ddots& \vdots\\
0 & \dots & \eps_t X_t^{l_0}
\epmat
\pmat
1& \dots & X_1^{\tau-1}\\
\vdots & & \vdots\\
1 & \dots & X_t^{\tau-1}\\
\epmat .
$$
Теперь, если $\tau=t$, то определитель этой матрицы не равен 0 и значит система однозначно разрешима. Если же $\tau>t$, то ранг первой матрицы меньше $\tau$. Значит и $\rk \Sigma_{\tau}<\tau$. В этом случае ясно, что определитель матрицы $\Sigma_{\tau}$ равен 0. Итого мы получаем следующий алгоритм исправления ошибок:
\enm 
\item Запускаем цикл по $\tau$ от 1 до $[(d-1)/2]$. Вычисляем $S_1,\dots,S_{2\tau}$ и вычисляем определители матриц $\Sigma_{\tau}$. Находим последний $\tau$ для которого этот определитель не ноль. Это и есть $t$. Решаем соответствующую систему и находим $\sigma_i$.
\item По $\sigma_i$ находим $X_l$ после чего находим позиции $i_l$. Это можно сделать подставив все возможные $\beta^i$ в $\chi(x)$.  
\item Далее, решив систему линейных уравнений можно найти $e_{i_l}$. Осталось  найти ответ по формуле $u(x)=v(x)-e(x)$.
\eenm

\subsection{Дополнительно: алгоритм Берлекэмпа-Мэсси}
Однако указанная матрица системы имеет очень регулярную структуру. Это наводит на мысль, что есть и более эффективные алгоритмы декодирования. Опишем алгоритм декодирования Берлекэмпа-Мэсси. Для этого нам надо проинтерпретировать указанную систему. Заметим, что элементы $S_1,\dots,S_d$ образуют кусок последовательности, заданной линейным реккурентным соотношением с характеристическим многочленом $x^t+\sigma_1x^{t-1}+\dots + \sigma_t= x^t \sigma(x^{-1})$.

При этом, данный многочлен является минимальным возможным для этой последовательности. Действительно, так как при $\tau =t$ определитель системы не ноль, то получаем, что есть единственный такой многочлен степени $\leq t$, который годится для элементов $S_1,\dots,S_{2t}$, а значит и для последовательности $S_1,\dots,S_{d-1}$. 

В общем виде, алгоритм Берлекэмпа-Мэсси по данной конечной последовательности $S_0,\dots, S_{N-1}$ ищет наименьшее линейное рекуррентное соотношение, которому удовлетворяет данная последовательность. 

Прежде всего перепишем условие, что последовательность $S_0,\dots, S_{N-1}$ удовлетворяет линейному рекуррентному соотношению  с коэффициентами $c_0,\dots, c_{k-1}, 1=c_k$. Рассмотрим многочлены $S(x)=S_0+\dots+S_{N-1}x^{N-1}$ и многочлен $\sigma(x)=c_0x^k+\dots + c_{k-1}x+1$. Тогда получаем, что 
$$S(x)\sigma(x)\equiv D(x) \mod x^N, \text{ где } \deg D(x) < k.$$
нам придётся отдельно говорить про степень $k$ так как её нельзя восстановить по $\sigma(x)$. Кроме того, при данном $k$ подходящий  $\sigma(x)$ не всегда единственный.


Будем искать $\sigma(x)$ и $k$ индуктивно. На $n$-ом шаге найдём наименьшее число $l_n$ и многочлен $\sigma_n(x)$ степени меньше $l_n$, которые решают задачу для $S_0,\dots, S_{n-1}$, где $n\leq N$. Иными словами, будет выполнено 
$$ S(x)\sigma_n(x) \equiv D_n(x) \mod x^n, \text{ где } \deg D_n(x) < l_n.$$
Заметим, что $l_n$ определено однозначно и всегда $l_n\leq n$ (если $l_n=n$, то это значит, что никаких соотношений в принципе нет). А  вот $\sigma_n(x)$ определено не всегда однозначно.



Посмотрим, как работает алгоритм. Если в последовательности $S_0,\dots,S_{n-1}$ одни нули, то будем считать степень $l_n$ соответствующей рекурренты равной $0$, а $\sigma_n=1$. Если же $S_{n-1}\neq 0$, но все предыдущие элементы нулевые, то очевидно на роль минимума годятся $l_n=n$ и $\sigma_n(x)=1= 1+0x+\dots+0x^n$.


Рассмотрим общую ситуацию. Пусть уже построено минимальное $l_n$ и соответствующее $\sigma_n$. Если $\sigma_n$ подходит и при добавлении $S_n$, то можно взять $l_n=l_{n+1}$ и $\sigma_{n+1}=\sigma_n$. 

Если же $\sigma_n$ не подходит, то
$$ S(x)\sigma_n(x) \equiv D_n(x)+d_nx^n \mod x^{n+1}, \text{ где } \deg D_n(x) < l_n$$
и $d_n\neq 0$. Если расписать явно, то $d_n=S_n+\sum_{k=0}^{l_n-1} c_k S_{n-l_n+k} \neq 0$, отвечает за то, что рекуррентное соотношение не выполнено для $S_n$. Посмотрим на наибольшее $m<n$, что $\sigma_m(x)\neq \sigma_n(x)$, то есть на предыдущее место изменения при построении $\sigma(x)$. Это даёт нам элемент $d_m\neq 0$, кроме того случая, когда было выполнено $S_0=\dots=S_{m-1}=0$, но $S_m\neq 0$. В этой ситуации $l_m=0$ и $d_m$ просто не вычислить. Будем считать, тогда, что $d_m=1$. Теперь, как только мы нашли $m,\sigma_m,d_m$ утверждается, что надо взять 
$$\sigma_{n+1}(x)= \sigma_n(x) - d_n d_m^{-1} x^{n-m} \sigma_m(x).$$
$$l_{n+1}=\max(l_n,n+1-l_n).$$

Для того, чтобы показать корректность этого алгоритма докажем вспомогательную лемму.

\lm[Ключевая] Пусть понадобилось поменять рекуррентное соотношение на шаге $n+1$. Тогда имеет место неравенство $l_{n+1}\geq n+1-l_n$. 
\elm
\proof  Предположим противное. Пусть $l_{n+1}\leq n-l_n$, то есть $l_{n+1}+l_n\leq n$. Распишем условие на $\sigma_n$ и $\sigma_{n+1}$ по модулю $x^{n+1}$.

$$\sigma_n S(x) \equiv D_n+d_nx^n \mod x^{n+1}$$
$$\sigma_{n+1}S(x)\equiv D_{n+1} \mod x^{n+1}$$
Так как $\sigma_n$ не подходит на роль $\sigma_{n+1}$, то $d_n\neq 0$. Домножая верхнее равенство на $\sigma_{n+1}$ получаем
$$ \sigma_{n+1}\sigma_n S(x) \equiv \sigma_{n+1}(D_n+d_nx^n) \equiv \sigma_n D_{n+1}\mod x^{n+1}$$
Заметим, что из неравенства, выражение, содержащее $d_nx^n$ имеет степень ровно $n$ после взятия остатка по модулю $x^{n+1}$, что не так для $\sigma_{n+1}D_n$ по тому же самому неравенству.
\endproof


\crl Пусть нам понадобилось поменять рекуррентное соотношение. Тогда $l_{n+1}\geq \max (l_n, n+1-l_n)$.
\ecrl

\proof[Корректность алгоритма]
Будем доказывать корректность алгоритма вместе со следующим утверждением: в предыдущем следствии при каждой смене $\sigma_i$ в алгоритме достигается равенство. 

Итак, пусть построены $\sigma_1(x),\dots, \sigma_n(x)$ и мы хотим построить $\sigma_{n+1}$.
В случае $d_n=0$ всё ясно. Пусть $d_n \neq 0$ и $m$ такое, что $l_m<l_n$, но $l_{m+1}=l_n$. Тогда по индукционному предположению имеем 
$$l_m<l_n = l_{m+1}=\max (l_m,m+1-l_m) $$
Отсюда получаем, что $l_n=m+1-l_m$. Возьмём
$$l_{n+1}=\max (l_n,n+1-l_n)=\max (l_n,n-m+l_m)$$
Условия следствия выполнены автоматически. Взятый нами $\sigma_{n+1}$ имеет степень меньшую или равную этого числа. Осталось проверить, что выполнено сравнение. 

$$\sigma_{n+1}S(x)\equiv d_n x^n+ 
D_n(x)+ d_nd_m^{-1}x^{n-m}(d_mx^m+ D_m(x)) \equiv D_n(x)-d_nd_m^{-1}x^{n-m}D_m(x) \mod x^{n+1}
$$
Оставшийся многочлен нужной степени. Отдельно стоит разобраться с базой индукции и началом работы алгоритма.
 

\endproof



